import requests
import os

def get_weather(city, api_key):
    url = f"http://api.openweathermap.org/data/2.5/weather?q={city}&appid={api_key}&units=metric"
    response = requests.get(url)

    if response.status_code != 200:
        print(f"⚠️ Error: {response.json().get('message', 'Could not fetch weather')}")
        return

    data = response.json()
    weather = {
        "city": data["name"],
        "country": data["sys"]["country"],
        "temp": data["main"]["temp"],
        "feels_like": data["main"]["feels_like"],
        "description": data["weather"][0]["description"].title(),
    }

    print(f"\n🌤️ Weather in {weather['city']}, {weather['country']}:")
    print(f"Temperature: {weather['temp']}°C (Feels like: {weather['feels_like']}°C)")
    print(f"Condition: {weather['description']}")

def main():
    print("☁️ Welcome to WeatherCLI")

    api_key = os.getenv("OPENWEATHER_API_KEY")
    if not api_key:
        print("❌ API key not found. Set the 'OPENWEATHER_API_KEY' environment variable.")
        return

    city = input("Enter city name: ")
    get_weather(city, api_key)

if __name__ == "__main__":
    main()
